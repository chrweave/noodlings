<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width,initial-scale=1" />
        <title>Password Generator</title>
    </head>
    <body>
        <h1>Password Generator</h1>
        <form id="cF">
            <table>
                <tr>
                    <td style="text-align: right;">Invisible Copy</td>
                    <td><input type="checkbox" id="ccB" unchecked /></td>
                </tr>
                <tr>
                    <td style="text-align: right;">Text Input:</td>
                    <td><input type="text" id="tI" value="calvin" required /></td>
                </tr>
                <tr>
                    <td style="text-align: right;">Number Input:</td>
                    <td><input type="number" id="nI" value="32" required /></td>
                </tr>
                <tr>
                    <td style="text-align: right;">Special Punctuation</td>
                    <td><input type="checkbox" id="sP" checked="checked" /></td>
                </tr>
                <tr>
                    <td style="text-align: right;">Lowercase Letters</td>
                    <td><input type="checkbox" id="lL" checked="checked" /></td>
                </tr>
                <tr>
                    <td style="text-align: right;">Uppercase Letters</td>
                    <td><input type="checkbox" id="uL" checked="checked" /></td>
                </tr>
                <tr>
                    <td style="text-align: right;">Numbers</td>
                    <td><input type="checkbox" id="nm" checked="checked" /></td>
                </tr>
                <tr>
                    <td style="text-align: right;"></td>
                    <td><input type="submit" value="Calculate" /></td>
                </tr>
            </table>
        </form>
        <p id="rP"></p>
        <script>
            var x, y, b, g;
            function p(e = 0) {
                return (y = (y + (t = b[(x = (x + 1) % l)]) + e) % l), (b[x] = b[y]), (b[y] = t), b[(t + b[x]) % l];
            }
            function gC(e) {
                for (a = p() % 4; !e.includes(a); ) a = p() % 4;
                return a;
            }
            function gI(e) {
                return document.getElementById(e);
            }
            function r(e, c) {
                for (x = 0, y = 0, b = Array.from({ length: l }, (e, c) => c), [...pF.value].map((e) => p(e.charCodeAt(0))), i = 0; i < 8 * l; i++) p();
                for (g = [gC(e), gC(e)]; (s = g.length) < pN.value; ) (a = gC(e)), (c < 2 || (a !== g[s - 1]) | (a !== g[s - 2])) && g.push(a);
                let o = g.map((e) => k[e][p() % k[e].length]).join("");
                tP.checked
                    ? navigator.clipboard
                          .writeText(o)
                          .then(function () {
                              (rP.textContent = "Result copied to clipboard!"), (pF.value = ""), (pN.value = "");
                          })
                          .catch(function (e) {
                              console.error("Failed to copy Result: ", e);
                          })
                    : (rP.textContent = o);
            }
            const tP = gI("ccB"),
                pF = gI("tI"),
                pN = gI("nI"),
                rP = gI("rP"),
                l = 1820,
                n = "abcdefghijklmnopqrstuvwxyz",
                k = ["!@#$._+", n, n.toUpperCase(), "0123456789"];
            tP.addEventListener("change", function () {
                this.checked ? (pF.type = "password") : ((pF.value = ""), (pF.type = "text"));
            }),
                gI("cF").addEventListener("submit", function (e) {
                    e.preventDefault();
                    var c = [],
                        o = 0;
                    ["sP", "lL", "uL", "nm"].map((e, u) => gI(e).checked && (c.push(u), o++)), o > 0 ? r(c, o) : alert("Please select at least one character class option.");
                });
        </script>
    </body>
</html>
