<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> </meta>
  <title>Ultra Violent Battle of Phrases</title>
</head>
<body>
  <div id="chooseYourNamePlayerOne" >
    <form id="player1form" onSubmit="return pOneName()" style="display:inline">
      <h2>
        Player 1 Character Name
      </h2>
      <input type="text" id="pone" style="width:100%"/>
      <input type="submit" />
    </form>
    <form id="player2form" onSubmit="return pTwoName()" style="display:none">
      <h2>
        Player 2 Character Name
      </h2>
      <input type="text" id="ptwo" style="width:100%"/>
      <input type="submit" />
    </form>
  </div>
  <div id="battle">
    <div>
      <h2>
        <table style="width:100%">
          <tr>
            <td style="float:left" id="p1n">
            </td>
            <td style="float:right" id="p2n">
            </td>
          </tr>
          <tr style="color:Red">
            <td style="float:left" id="p1h">
            </td>
            <td style="float:right" id="p2h">
            </td>
          </tr>
          <tr style="color:Green">
            <td style="float:left" id="p1action">
            </td>
            <td style="float:right" id="p2action">
            </td>
          </tr>
        </table> 
      </h2>
    </div><br/>
    <div style="display:block">
      <h1 id="actionBanner">
      </h1>
      <form id="actionForm" onSubmit="return handleAction()" style="display:none">
        <input type="text" id="myAction" style="width:100%"/>
        <input type="submit" />
      </form>
	  <form id="victoryForm" onSubmit="return handleVictory()" style="display:none">
        <input type="submit" />
      </form>
	  <form id="totalVictoryForm" onSubmit="return resetGame()" style="display:none">
        <input type="submit" />
      </form>
    </div>
  </div>
  <script>
    var p1form=document.getElementById("player1form");
    var p2form=document.getElementById("player2form");
    var myNames=["",""];
    var health=[0,0];
    var turnToggle = 0;
    var attackToggle = 0;
    var xi=0;
    var xj=0;
    var lim=1000;
    function pOneName(){
      myNames[0]=document.getElementById("pone").value;
      document.getElementById("p1n").innerHTML=myNames[0];
      p1form.style.display = "none";
      p2form.style.display = "inline";
      return false;
    }
    function gethash (word){
      var hash = 11720509;
      var prime = 1048837; 
      var nums=numberize(word);
      var  i = 0;
      for(i=0;i<nums.length;i++){
        hash=hash^nums[i];
        hash*=prime;
        hash&=0xffffff;
      }
      return hash;
    }
    function numberize (e){
      return e.split("").map(x => x.charCodeAt([0]));
    }
    function pTwoName(){     
      myNames[1]=document.getElementById("ptwo").value; 
      document.getElementById("p2n").innerHTML=myNames[1];
      p2form.style.display = "none";
      resetGame();
      return false;
    }
    function handleAction(){
      if(turnToggle==0){
        health[0]++;
        health[1]++;
        if(attackToggle==0){
          document.getElementById("p1action").innerHTML=document.getElementById("myAction").value;
          document.getElementById("myAction").value = "";
          document.getElementById("actionBanner").innerHTML=myNames[1]+" Defense:"
          document.getElementById("p1h").innerHTML= health[0];
          document.getElementById("p2h").innerHTML= health[1];
        } else {
          document.getElementById("p2action").innerHTML=document.getElementById("myAction").value;
          document.getElementById("myAction").value = "";
          document.getElementById("actionBanner").innerHTML=myNames[1]+" Attack:"
          document.getElementById("p1h").innerHTML= health[0];
          document.getElementById("p2h").innerHTML= health[1];
        }
      } else {
        if(attackToggle==0){
          document.getElementById("p2action").innerHTML=document.getElementById("myAction").value;
          document.getElementById("myAction").value = "";
          document.getElementById("actionBanner").innerHTML=myNames[0]+" Defense:"
          document.getElementById("p1h").innerHTML= health[0];
          document.getElementById("p2h").innerHTML= health[1];
        } else {
          document.getElementById("p1action").innerHTML=document.getElementById("myAction").value;
          document.getElementById("myAction").value = "";
          document.getElementById("actionBanner").innerHTML=myNames[0]+" Attack:"
          document.getElementById("p1h").innerHTML= health[0];
          document.getElementById("p2h").innerHTML= health[1];
        }
      }
      if(attackToggle==1){
        turnToggle=1-turnToggle;
      }
      attackToggle = 1-attackToggle;
      return false;
    }
    function calculateVictor(attackNum,defenseNum, toggle){
      if (attackNum > defenseNum){
	    if(toggle == 0){
		  
		  document.getElementById("actionBanner").innerHTML=myNames[0]+" wins the battle!"
		} else{
		}
      }
      if(attackNum == defenseNum){
        return 0;
      }
      return -1;
    }
    function calculateDamage(health,num,threshold){
      num -= thresh;
      num /= 16777216;
      num *= 10;
      num = health+Math.round(num);
	  if(num < 0){
		num=0;
	  }
	  return num;
    }
    function calculateBattle(attacker, attack, defender, defence, toggle){
      var anum = gethash(attacker+attack);
      var dnum = gethash(defender+defense);
      var thresh = gethash(attack+defense);      
      if(toggle == 0){
        p1health+=calculateDamage(p1health,anum,thresh);
        p2health+=calculateDamage(p2health,dnum,thresh);
      } else {
        p2health+=calculateDamage(p2health,anum,thresh);
        p1hea1th+=calculateDamage(p1health,dnum,thresh);
      }	  
      var victor = calculateVictor(anum,dnum,toggle);
    }
	function handleVictory(){
		if(p2health == 0){
		}
	}
    function resetGame(){
      health[0]= health[1] =100; 
      document.getElementById("actionForm").style.display="inline";
      document.getElementById("actionBanner").innerHTML=myNames[0]+" Attack:"
      document.getElementById("p1h").innerHTML= health[0];
      document.getElementById("p2h").innerHTML= health[1];
      return false;
    }
  </script>              
</body>
</html>
